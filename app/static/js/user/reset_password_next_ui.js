function btnLoading(t){t.attr("disabled",!0),t.val("Loading...")}function btnClearLoading(t,n){t.attr("disabled",!1),t.val(n)}$(function(){function t(){var t=r.val();return 0===t.length?(s.fadeIn("100").text("请输入密码"),!1):t.length<6?(s.fadeIn("100").text("密码至少6位"),!1):t.length>32?(s.fadeIn("100").text("密码不超过32位"),!1):(s.fadeOut("50").text(" "),!0)}function n(){var t=r.val(),n=o.val();return t!=n?(d.fadeIn("100").text("两次密码不一致"),!1):(d.fadeOut("50").text(" "),!0)}var e="/login",a="/reset_password_next",r=$("#password"),o=$("#confirm_pwd"),i=$("#csrf_token"),f=$("#submit_reg"),s=$(".err-tip.password"),d=$(".err-tip.confirm_pwd"),c=$(".err-tip.result");r.blur(function(){t()&&o.length>0&&n()}),o.blur(function(){n()}),f.click(function(f){if(f.preventDefault(),c.fadeOut("50").text(" "),t()&&n()){var s=$(this),d=s.val();btnLoading(s),$.ajax({type:"POST",url:a,data:{csrf_token:i.val(),password:encrypt(r.val()),confirm_password:encrypt(o.val())},success:function(t){t.success?(c.fadeIn("100").text("重置成功,将返回登录页面"),setTimeout(function(){window.location.href=e},1e3)):(btnClearLoading(s,d),c.fadeIn("100").text(t.message))},error:function(t,n,e){console.error(a,n,e.toString())}})}})});