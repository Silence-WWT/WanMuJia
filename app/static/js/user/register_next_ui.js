function btnLoading(t){t.attr("disabled",!0),t.val("Loading...")}function btnClearLoading(t,e){t.attr("disabled",!1),t.val(e)}$(function(){function t(){var t=i.val();return 0===t.length?(d.fadeIn("100").text("昵称不能为空"),!1):t.length<4?(d.fadeIn("100").text("昵称不能小于4个字符"),!1):t.length>30?(d.fadeIn("100").text("昵称不能大于30个字符"),!1):(d.fadeOut("50").text(" "),!0)}function e(){var t=o.val();return 0===t.length?(u.fadeIn("100").text("请输入密码"),!1):t.length<6?(u.fadeIn("100").text("密码至少6位"),!1):t.length>32?(u.fadeIn("100").text("密码不超过32位"),!1):(u.fadeOut("50").text(" "),!0)}function n(){var t=o.val(),e=f.val();return t!=e?(s.fadeIn("100").text("两次密码不一致"),!1):(s.fadeOut("50").text(" "),!0)}var a="/register_result",r="/register_next",i=$("#nickname"),o=$("#password"),f=$("#confirm_pwd"),l=$("#csrf_token"),c=$("#submit_reg"),d=$(".err-tip.nickname"),u=$(".err-tip.password"),s=$(".err-tip.confirm_pwd"),g=$(".err-tip.result");i.blur(function(){t()}),o.blur(function(){e()&&f.length>0&&n()}),f.blur(function(){n()}),c.click(function(c){if(c.preventDefault(),g.fadeOut("50").text(" "),t()&&e()&&n()){var d=$(this),u=d.val();btnLoading(d),$.ajax({type:"POST",url:r,data:{csrf_token:l.val(),nickname:i.val(),password:encrypt(o.val()),confirm_password:encrypt(f.val())},success:function(t){btnClearLoading(d,u),t.success?(g.fadeIn("100").text("注册成功"),window.location.href=a):g.fadeIn("100").text(t.message)},error:function(t,e,n){console.error(r,e,n.toString())}})}})});