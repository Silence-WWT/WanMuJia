$(function(){var e="/",t=window.location.search;t.length>0&&(e=t.substr(t.indexOf("next")+5)),console.log(e);var n=$("#username"),r=$("#password"),a=$("#next"),i=$("#csrf_token"),o=$("form").attr("action"),s=$(".err-tip.username"),c=$(".err-tip.psw"),d=$(".err-tip.result");n.change(function(){s.hide().text(""),d.hide().text("")}),r.change(function(){c.hide().text(""),d.hide().text("")}),a.click(function(t){return t.preventDefault(),s.hide().text(""),c.hide().text(""),d.hide().text(""),0===n.val().length?(s.fadeIn("50").text("用户名/手机/邮箱不能为空"),!1):0===r.val().length?(c.fadeIn("50").text("密码不能为空"),!1):($(this).attr("disabled",!0),void $.ajax({type:"POST",url:o,data:{csrf_token:i.val(),username:n.val(),password:encrypt(r.val())},success:function(t){a.removeAttr("disabled"),t.success?(d.fadeIn().text("登录成功"),window.location.href=e):d.fadeIn("50").text(t.message)},error:function(e,t,n){console.error(o,t,n.toString())}}))})});